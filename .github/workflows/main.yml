name: Deploy Examples

on:
  # Triggers the workflow on push or pull request events but only for the main branch
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

jobs:
  # astro:
  #   name: Deploy Astro
  #   runs-on: ubuntu-latest
  #   permissions:
  #     id-token: write
  #     contents: read
  #   steps:
  #     - name: Checkout
  #       uses: actions/checkout@v3
  #     - name: Setup Astro
  #       uses: 
  eleventy:
    name: Deploy Eleventy
    defaults:
      run:
        working-directory: with-eleventy
    runs-on: ubuntu-latest
    permissions:
      id-token: write
      contents: read
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: 16
      - run: npm install
      - run: npm run build
      - uses: denoland/deployctl@v1
        with:
          project: examples-deno-eleventy
          entrypoint: https://deno.land/std@0.131.0/http/file_server.ts
          root: with-eleventy/_site
  hugo:
    name: Deploy Hugo
    defaults:
      run:
        working-directory: with-hugo
    runs-on: ubuntu-latest
    permissions:
      id-token: write
      contents: read
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Setup Hugo
        uses: peaceiris/actions-hugo@v2
        with:
          hugo-version: 'latest'
      - name: Build
        run: hugo --minify
      - name: Deploy
        uses: denoland/deployctl@v1
        with:
          project: examples-deno-hugo
          entrypoint: https://deno.land/std@0.131.0/http/file_server.ts
          root: with-hugo/public
  jekyll:
    name: Deploy Jekyll
    defaults:
      run:
        working-directory: with-jekyll
    runs-on: ubuntu-latest
    permissions:
      id-token: write
      contents: read
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Build
        uses: vivi90/jekyll-minimal-action@v1.1.0
        with:
          command: cd with-jekyll && jekyll build

      - name: Deploy
        uses: denoland/deployctl@v1
        with:
          project: examples-deno-jekyll
          entrypoint: https://deno.land/std@0.131.0/http/file_server.ts
          root: with-jekyll/_site

